<!-- editTopic.ejs -->
<!DOCTYPE html>
<html>

  <title>Edit Topic</title>
  <%- include('partials/header') %>

<body>
  <!-- Navigation -->
  <% if(admin){ %>
    <%- include('partials/navBar') %>
    <%}else {%>
      <%- include('partials/clientNav') %>    
    <%}%> 
  
  <h1>Edit Topic</h1>
  <a href="/course/course-topics/<%= topic.courseId%>"> <button >Back</button></a>
  <form action="/topics/edit/<%= topic._id %>" method="POST">
    <div>
      <label for="topicTitle">Topic Title:</label>
      <input type="text" id="topicTitle" name="topicTitle" value="<%= topic.title %>" >
    </div>
    <div>

      <input type="hidden" id="topicNo" name="topicNo" value="<%= topic.topicNo %>" >
    </div>
    <div>
      <label for="topicDesc">Topic Description:</label>
      <textarea id="topicDesc" name="topicDesc" rows="4" ><%= topic.topicDesc %></textarea>
    </div>
    <% if(topicMaterial != null){ %>
    <div>
      <label for="materialTitle">Material Title:</label>
      <input type="text" id="materialTitle" name="materialTitle" value="<%= topicMaterial.title %>">
    </div>
    <div>
      <label for="materialContent">Material Content:</label>
      <textarea id="materialContent" name="materialContent" rows="6"><%= topicMaterial.content %></textarea>
    </div>
    <div>
      <label for="materialVideo">Material Video:</label>
      <input type="text" id="materialVideo" name="materialVideo" value="<%= topicMaterial.topicVideo %>">
      <input type="hidden" id="materialVideo" name="courseId" value="for-validation-only">
    </div>
    <%} %><br/>
    <% if(quiz){ %>
    <a href="/topics/quiz/<%=topic._id %>">
    View topic quiz</a>
    <button><a href="#" id="deleteQuiz" data-delete-quiz-data="<%=topic._id %>">
      delete quiz</a></button><br/><br/>
    <%} else{%>
      You haven't created a quiz for this topic 
     <br/><br/>
    <button><a href="/topics/createQuiz/<%=topic._id %>">
    Create topic quiz</a></button><br/><br/>
    <%}%>
    <button type="submit">Update</button>
  </form>
  <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
    <div class="errors">
      <% errors.forEach(function (error) { %>
        <p class="error-message"><%= error.msg %></p>
      <% }) %>
    </div>
  <% } %>

  <script>
    $(document).ready(function (){

      $('#deleteQuiz').click(function (event){
        event.preventDefault;
        var deleteLink = $(this).data("delete-quiz-data");
        var link = '../deleteQuiz/'+deleteLink;
     
        $.ajax({
          url:link,
          type:'DELETE',
          success:function (response){
            console.log(response);
            location.reload();
          },
          error: function(response){
            console.log(response);
          }
        });
      });

    });
  </script>
 <%- include('partials/footer') %>
</body>
</html>